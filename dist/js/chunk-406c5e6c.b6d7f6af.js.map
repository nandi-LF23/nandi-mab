{"version":3,"sources":["webpack:///./src/views/Pages/CompanyManagementReport.vue?b2cf","webpack:///src/views/Pages/CompanyManagementReport.vue","webpack:///./src/views/Pages/CompanyManagementReport.vue?5969","webpack:///./src/views/Pages/CompanyManagementReport.vue","webpack:///./src/util/mab-utils.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","directives","name","rawName","value","expression","on","loadReport","model","report_params","callback","$$v","$set","_l","year","index","key","company","company_name","id","userCan","loading","company_ids","length","nativeOn","$event","getPdfReport","_e","row","_s","parent_co","subsidiary","node_type","node_count","field_name","node_address","node_est","summary","totals","row_type","sm_count","nutrients_count","wells_count","meters_count","popcols","line_total","staticRenderFns","mixins","components","Modal","data","initial","details","years","companies","type","detailed","mode","methods","$axios","post","then","params","window","created","component","calcLastReadingColor","obj","color","date_diff","h","d","days","y","m","isAdmin","email","$store","getters","isDistributor","isRestricted","permission","subsystem","object_id","object_type","userLimits","convertNodeTypeToGraphRouteName","convertNodeTypeToSubsystem","convertToInches","val","replace","parseInt","convertToIndex","truncateString","str","substring"],"mappings":"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","file":"js/chunk-406c5e6c.b6d7f6af.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('base-header',{staticClass:\"pb-6\",attrs:{\"type\":\"company\"}},[_c('b-row',{staticClass:\"py-4\",attrs:{\"align-v\":\"center\"}},[_c('b-col',[_c('h6',{staticClass:\"h2 text-white d-inline-block mb-0 mr-5\"},[_vm._v(\"\\n          Entity Management - Reporting\\n        \")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"mab_spinner light right\"})])],1)],1),_c('div',{staticClass:\"container-fluid mt--6\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-12\"},[_c('b-card',[_c('b-card-text',[_c('h3',[_vm._v(\"Device Placement\")]),_c('b-row',[_c('b-col',{attrs:{\"md\":\"\"}},[_c('base-input',{attrs:{\"label\":\"Year\"}},[_c('el-select',{on:{\"change\":_vm.loadReport},model:{value:(_vm.report_params.year),callback:function ($$v) {_vm.$set(_vm.report_params, \"year\", $$v)},expression:\"report_params.year\"}},[_vm._l((_vm.years),function(year,index){return [_c('el-option',{key:index,attrs:{\"label\":year,\"value\":year}})]})],2)],1)],1),_c('b-col',{attrs:{\"md\":\"\"}},[_c('base-input',{attrs:{\"label\":\"Entities\"}},[_c('el-select',{attrs:{\"value-key\":\"id\",\"multiple\":\"\",\"filterable\":\"\",\"collapse-tags\":\"\"},on:{\"change\":_vm.loadReport},model:{value:(_vm.report_params.company_ids),callback:function ($$v) {_vm.$set(_vm.report_params, \"company_ids\", $$v)},expression:\"report_params.company_ids\"}},[_vm._l((_vm.companies),function(company,index){return [_c('el-option',{key:index,attrs:{\"label\":company.company_name,\"value\":company.id}})]})],2)],1)],1),_c('b-col',{attrs:{\"md\":\"\"}},[_c('base-input',{attrs:{\"label\":\"Detailed\"}},[_c('b-form-checkbox',{attrs:{\"value\":true,\"unchecked-value\":false,\"size\":\"lg\"},on:{\"change\":_vm.loadReport},model:{value:(_vm.report_params.detailed),callback:function ($$v) {_vm.$set(_vm.report_params, \"detailed\", $$v)},expression:\"report_params.detailed\"}},[_vm._v(\"\\n                    Detailed Report\\n                  \")])],1)],1),_c('b-col',{attrs:{\"md\":\"\"}},[_c('base-input',{attrs:{\"label\":\"Export\"}},[_c('base-button',{staticClass:\"btn\",attrs:{\"disabled\":!_vm.userCan('Report', 'Entities') || _vm.loading || _vm.report_params.company_ids.length == 0,\"size\":\"sm\",\"type\":\"primary\",\"icon\":\"\"},nativeOn:{\"click\":function($event){return _vm.getPdfReport()}}},[_vm._v(\"\\n                    Export to PDF\\n                  \")])],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"md\":\"\"}},[(_vm.report_params.detailed)?_c('h3',[_vm._v(\"Details\")]):_vm._e(),(_vm.report_params.detailed)?_c('b-table-simple',{attrs:{\"striped\":\"\",\"responsive\":\"\"}},[_c('b-thead',[_c('b-tr',[_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Distributor\")]),_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Subsidiary\")]),_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Node Type\")]),_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Qty\")]),_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Field\")]),_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Node Address\")]),_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Node EST\")])],1)],1),_c('b-tbody',[_vm._l((_vm.details),function(row){return [_c('b-tr',[_c('b-td',[_vm._v(_vm._s(row.parent_co))]),_c('b-td',[_vm._v(_vm._s(row.subsidiary))]),_c('b-td',[_vm._v(_vm._s(row.node_type))]),_c('b-td',{staticClass:\"text-right\"},[_vm._v(_vm._s(row.node_count))]),_c('b-td',[_vm._v(_vm._s(row.field_name))]),_c('b-td',[_vm._v(_vm._s(row.node_address))]),_c('b-td',{staticClass:\"text-right\"},[_vm._v(_vm._s(row.node_est))])],1)]})],2)],1):_vm._e()],1)],1),_c('b-row',[_c('b-col',{attrs:{\"md\":\"\"}},[(_vm.summary && _vm.totals)?_c('h3',{attrs:{\"responsive\":\"\"}},[_vm._v(\"Summary\")]):_vm._e(),(_vm.summary && _vm.totals)?_c('b-table-simple',{attrs:{\"striped\":\"\",\"responsive\":\"\"}},[_c('b-thead',[_c('b-tr',[_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Distributor\")]),_c('b-th',{staticClass:\"text-left\"},[_vm._v(\"Subsidiary\")]),(_vm.totals.sm_total)?_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Soil Moisture\")]):_vm._e(),(_vm.totals.nt_total)?_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Nutrients\")]):_vm._e(),(_vm.totals.wl_total)?_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Well Controls\")]):_vm._e(),(_vm.totals.mt_total)?_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Meters\")]):_vm._e(),_c('b-th',{staticClass:\"text-right\"},[_vm._v(\"Line Total\")])],1)],1),_c('b-tbody',[_vm._l((_vm.summary),function(row){return [_c('b-tr',[_c('b-td',[_vm._v(_vm._s(row.parent_co))]),_c('b-td',[_vm._v(_vm._s(row.subsidiary))]),(row.row_type == 'Data')?[(_vm.totals.sm_total)?_c('b-td',{staticClass:\"text-right\"},[_c('strong',[_vm._v(_vm._s(row.sm_count))])]):_vm._e(),(_vm.totals.nt_total)?_c('b-td',{staticClass:\"text-right\"},[_c('strong',[_vm._v(_vm._s(row.nutrients_count))])]):_vm._e(),(_vm.totals.wl_total)?_c('b-td',{staticClass:\"text-right\"},[_c('strong',[_vm._v(_vm._s(row.wells_count))])]):_vm._e(),(_vm.totals.mt_total)?_c('b-td',{staticClass:\"text-right\"},[_c('strong',[_vm._v(_vm._s(row.meters_count))])]):_vm._e()]:(row.row_type == 'Subtotal' || row.row_type == 'Total')?[_c('b-td',{staticClass:\"text-right\",attrs:{\"colspan\":_vm.popcols}},[_vm._v(_vm._s(row.row_type))])]:_vm._e(),_c('b-td',{staticClass:\"text-right\"},[_vm._v(_vm._s(row.line_total))])],2)]})],2)],1):_vm._e()],1)],1)],1)],1)],1)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"content\">\r\n    <base-header class=\"pb-6\" type=\"company\">\r\n      <b-row align-v=\"center\" class=\"py-4\">\r\n        <b-col>\r\n          <h6 class=\"h2 text-white d-inline-block mb-0 mr-5\">\r\n            Entity Management - Reporting\r\n          </h6>\r\n          <div v-show='loading' class='mab_spinner light right'></div>\r\n        </b-col>\r\n      </b-row>\r\n    </base-header>\r\n\r\n    <div class='container-fluid mt--6'>\r\n      <div class='row'>\r\n        <div class='col-md-12'>\r\n          <b-card>\r\n            <b-card-text>\r\n              <h3>Device Placement</h3>\r\n\r\n              <b-row>\r\n                <b-col md>\r\n                  <base-input label=\"Year\">\r\n                    <el-select @change=\"loadReport\" v-model=\"report_params.year\">\r\n                      <template v-for=\"(year,index) in years\">\r\n                        <el-option :key=\"index\" :label=\"year\" :value=\"year\"></el-option>\r\n                      </template>\r\n                    </el-select>\r\n                  </base-input>\r\n                </b-col>\r\n                <b-col md>\r\n                  <base-input label=\"Entities\">\r\n                    <el-select @change=\"loadReport\" v-model=\"report_params.company_ids\" value-key=\"id\" multiple filterable collapse-tags>\r\n                      <template v-for=\"(company,index) in companies\">\r\n                        <el-option :key=\"index\" :label=\"company.company_name\" :value=\"company.id\"></el-option>\r\n                      </template>\r\n                    </el-select>\r\n                  </base-input>\r\n                </b-col>\r\n                <b-col md>\r\n                  <base-input label=\"Detailed\">\r\n                    <b-form-checkbox @change=\"loadReport\" v-model=\"report_params.detailed\" :value=\"true\" :unchecked-value=\"false\" size=\"lg\">\r\n                      Detailed Report\r\n                    </b-form-checkbox>\r\n                  </base-input>\r\n                </b-col>\r\n                <b-col md>\r\n                  <base-input label=\"Export\">\r\n                    <base-button\r\n                      :disabled=\"!userCan('Report', 'Entities') || loading || report_params.company_ids.length == 0\"\r\n                      @click.native=\"getPdfReport()\"\r\n                      class=\"btn\"\r\n                      size=\"sm\"\r\n                      type=\"primary\"\r\n                      icon>\r\n                      Export to PDF\r\n                    </base-button>\r\n                  </base-input>\r\n                </b-col>\r\n              </b-row>\r\n\r\n              <b-row>\r\n                <b-col md>\r\n                  <h3 v-if=\"report_params.detailed\">Details</h3>\r\n                  <b-table-simple striped responsive v-if=\"report_params.detailed\">\r\n                    <b-thead>\r\n                      <b-tr>\r\n                        <b-th class='text-left'>Distributor</b-th>\r\n                        <b-th class='text-left'>Subsidiary</b-th>\r\n                        <b-th class='text-left'>Node Type</b-th>\r\n                        <b-th class='text-right'>Qty</b-th>\r\n                        <b-th class='text-left'>Field</b-th>\r\n                        <b-th class='text-left'>Node Address</b-th>\r\n                        <b-th class='text-right'>Node EST</b-th>\r\n                      </b-tr>\r\n                    </b-thead>\r\n                    <b-tbody>\r\n                      <template v-for=\"row in details\">\r\n                        <b-tr>\r\n                          <b-td>{{ row.parent_co }}</b-td>\r\n                          <b-td>{{ row.subsidiary }}</b-td>\r\n                          <b-td>{{ row.node_type }}</b-td>\r\n                          <b-td class='text-right'>{{ row.node_count }}</b-td>\r\n                          <b-td>{{ row.field_name }}</b-td>\r\n                          <b-td>{{ row.node_address }}</b-td>\r\n                          <b-td class='text-right'>{{ row.node_est }}</b-td>\r\n                        </b-tr>\r\n                      </template>\r\n                    </b-tbody>\r\n                  </b-table-simple>\r\n                </b-col>\r\n              </b-row>\r\n\r\n              <b-row>\r\n                <b-col md>\r\n                  <h3 responsive v-if=\"summary && totals\">Summary</h3>\r\n                  <b-table-simple striped responsive v-if=\"summary && totals\">\r\n                    <b-thead>\r\n                      <b-tr>\r\n                        <b-th class='text-left'>Distributor</b-th>\r\n                        <b-th class='text-left'>Subsidiary</b-th>\r\n                        <b-th class='text-right' v-if=\"totals.sm_total\">Soil Moisture</b-th>\r\n                        <b-th class='text-right' v-if=\"totals.nt_total\">Nutrients</b-th>\r\n                        <b-th class='text-right' v-if=\"totals.wl_total\">Well Controls</b-th>\r\n                        <b-th class='text-right' v-if=\"totals.mt_total\">Meters</b-th>\r\n                        <b-th class='text-right'>Line Total</b-th>\r\n                      </b-tr>\r\n                    </b-thead>\r\n                    <b-tbody>\r\n                      <template v-for=\"row in summary\">\r\n                        <b-tr>\r\n                          <b-td>{{ row.parent_co }}</b-td>\r\n                          <b-td>{{ row.subsidiary }}</b-td>\r\n\r\n                            <template v-if=\"row.row_type == 'Data'\">\r\n                              <b-td v-if=\"totals.sm_total\" class='text-right'><strong>{{ row.sm_count }}</strong></b-td>\r\n                              <b-td v-if=\"totals.nt_total\" class='text-right'><strong>{{ row.nutrients_count }}</strong></b-td>\r\n                              <b-td v-if=\"totals.wl_total\" class='text-right'><strong>{{ row.wells_count }}</strong></b-td>\r\n                              <b-td v-if=\"totals.mt_total\" class='text-right'><strong>{{ row.meters_count }}</strong></b-td>\r\n                            </template>\r\n                            <template v-else-if=\"row.row_type == 'Subtotal' || row.row_type == 'Total'\">\r\n                              <b-td :colspan=\"popcols\" class='text-right'>{{ row.row_type }}</b-td>\r\n                            </template>\r\n                            <b-td class='text-right'>{{ row.line_total }}</b-td>\r\n\r\n                        </b-tr>\r\n                      </template>\r\n                    </b-tbody>\r\n                  </b-table-simple>\r\n                </b-col>\r\n              </b-row>\r\n\r\n            </b-card-text>\r\n          </b-card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Modal from '@/components/Modal'\r\nimport { Select, Option } from 'element-ui'\r\nimport swal from 'sweetalert2';\r\nimport mab_utils from '../../util/mab-utils';\r\n\r\nexport default {\r\n\r\n  mixins: [ mab_utils ],\r\n\r\n  components: {\r\n    [Select.name]: Select,\r\n    [Option.name]: Option,\r\n    Modal\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      initial: true,\r\n\r\n      summary: [],\r\n      totals:  [],\r\n      popcols: 0,\r\n      details: [],\r\n      years: [],\r\n      companies: [], // all distributor company ids\r\n\r\n      report_params: {\r\n        type: 'json',\r\n        company_ids: [], // selected distributor/subsidiary company ids\r\n        year: 'Total',\r\n        detailed: false,\r\n        mode: 'dist',\r\n        initial: true\r\n      }\r\n\r\n    };\r\n  },\r\n\r\n  methods: {\r\n\r\n    loadReport()\r\n    {\r\n      this.$axios.post(\"/api/company_report\", this.report_params)\r\n      .then((resp) => {\r\n        this.loading = false;\r\n        this.report_params.initial = false;\r\n        this.summary = resp.data.summary;\r\n        this.totals  = resp.data.totals;\r\n\r\n        this.popcols = 0;\r\n        this.popcols += this.totals.sm_total > 0 ? 1 : 0;\r\n        this.popcols += this.totals.nt_total > 0 ? 1 : 0;\r\n        this.popcols += this.totals.wl_total > 0 ? 1 : 0;\r\n        this.popcols += this.totals.mt_total > 0 ? 1 : 0;\r\n\r\n        if(resp.data.details){\r\n          this.details = resp.data.details;\r\n        }\r\n        if(resp.data.years){\r\n          this.years = resp.data.years;\r\n        }\r\n        this.companies = resp.data.companies;\r\n        if(this.initial){\r\n          this.report_params.company_ids = resp.data.cc_ids;\r\n          this.initial = false;\r\n        }\r\n      });\r\n    },\r\n\r\n    getPdfReport(){\r\n\r\n      const params = Object.assign({}, this.report_params);\r\n      params.type = 'pdf';\r\n\r\n      this.$axios.post(\"/api/company_report\", params)\r\n      .then((resp) => {\r\n        this.loading = false;\r\n        if(resp.data.url){\r\n          window.open(resp.data.url);\r\n        }\r\n      });\r\n      \r\n    },\r\n  },\r\n\r\n  created()\r\n  {\r\n    this.loadReport();\r\n  }\r\n};\r\n</script>\r\n<style>\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyManagementReport.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyManagementReport.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CompanyManagementReport.vue?vue&type=template&id=19baba11&\"\nimport script from \"./CompanyManagementReport.vue?vue&type=script&lang=js&\"\nexport * from \"./CompanyManagementReport.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n  methods: {\n    \n    // Calculate Node's Last Reading Date Color\n    calcLastReadingColor(obj)\n    {\n      let color = 'black';\n      if(typeof obj.date_diff !== \"undefined\" && obj.date_diff != 'N/A'){\n        if(obj.date_diff.h < 3){ color = 'green'; }\n        if(obj.date_diff.h >= 3 && obj.date_diff.h < 6){ color = 'orange'; }\n        if(obj.date_diff.h >= 6){ color = 'red'; }\n        if(obj.date_diff.d > 0 || obj.date_diff.days > 0){ color = 'red'; }\n        if(obj.date_diff.y > 0 || obj.date_diff.m > 0 || obj.date_diff.d > 0 || obj.date_diff.days > 0){ color = 'red'; }\n      }\n      return color;\n    },\n\n    isAdmin(email = '')\n    {\n      return this.$store.getters.isAdmin(email);\n    },\n\n    isDistributor(email = '')\n    {\n      return this.$store.getters.isDistributor(email);\n    },\n\n    isRestricted()\n    {\n      return this.$store.getters.isRestricted();\n    },\n\n    userCan(permission, subsystem, object_id = null, object_type = '')\n    {\n      return this.$store.getters.userCan(permission, subsystem, object_id, object_type);\n    },\n\n    userLimits(permission, subsystem, object_type = ''){\n      return this.$store.getters.userLimits(permission, subsystem, object_type);\n    },\n\n    convertNodeTypeToGraphRouteName(type){\n      if(type == 'Soil Moisture'){\n        return 'soil_moisture_graph';\n      } else if(type == 'Nutrients'){\n        return 'nutrients_graph';\n      } else if(type == 'Wells'){\n        return 'well_controls_graph';\n      } else if(type == 'Water Meter'){\n        return 'meters_graph';\n      } else {\n        return '';\n      }\n    },\n\n    convertNodeTypeToSubsystem(type){\n      if(type == 'Soil Moisture'){\n        return 'Soil Moisture';\n      } else if(type == 'Nutrients'){\n        return 'Nutrients';\n      } else if(type == 'Wells'){\n        return 'Well Controls';\n      } else if(type == 'Water Meter'){\n        return 'Meters';\n      } else {\n        return '';\n      }\n    },\n\n    /* To be used exclusively with Sensor Dropdowns / Checkbox Lists */\n    convertToInches(val){\n      val = val.replace('mm','');\n      val = parseInt(parseInt(val) / 25) + '\"';\n      return val;\n    },\n\n    /* \" */\n    convertToIndex(val){\n      val = val.replace('mm','');\n      val = parseInt(parseInt(val) / 100);\n      return val;\n    },\n\n    truncateString(str){\n      return str.length <= 24 ? str: (str.substring(0, 21) + '...');\n    }\n\n  }\n}\n"],"sourceRoot":""}