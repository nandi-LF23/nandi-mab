{"version":3,"sources":["webpack:///./src/util/mab-utils.js","webpack:///./src/views/Pages/Dashboard.vue?3b2a","webpack:///./src/views/Pages/Dashboard.vue?1665","webpack:///src/views/Pages/Dashboard.vue","webpack:///./src/views/Pages/Dashboard.vue?814b","webpack:///./src/views/Pages/Dashboard.vue"],"names":["methods","calcLastReadingColor","obj","color","date_diff","h","d","days","y","m","isAdmin","email","this","$store","getters","isDistributor","isRestricted","userCan","permission","subsystem","object_id","object_type","userLimits","convertNodeTypeToGraphRouteName","type","convertNodeTypeToSubsystem","convertToInches","val","replace","parseInt","convertToIndex","truncateString","str","length","substring","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","directives","name","rawName","value","expression","on","loadDashboardData","model","callback","$$v","perPage","filterNodeType","_l","item","index","key","label","filterText","tableColumns","tableData","bInitialQuery","sortingChanged","$event","scopedSlots","_u","fn","data","node_type","id","params","node_address","_s","style","proxy","slot","Math","min","currentPage","totalRows","staticRenderFns","mixins","loading","tableLoading","sortable","tdClass","sortBy","sortDir","nodeTypes","refreshTimer","$axios","post","state","baseUrl","cur_page","per_page","initial","filter","sort_by","sort_dir","then","e","sortDesc","mounted","watch","beforeRouteLeave","to","from","next","clearInterval","component"],"mappings":"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","file":"js/chunk-dbb553b2.1e62445c.js","sourcesContent":["export default {\n  methods: {\n    \n    // Calculate Node's Last Reading Date Color\n    calcLastReadingColor(obj)\n    {\n      let color = 'black';\n      if(typeof obj.date_diff !== \"undefined\" && obj.date_diff != 'N/A'){\n        if(obj.date_diff.h < 3){ color = 'green'; }\n        if(obj.date_diff.h >= 3 && obj.date_diff.h < 6){ color = 'orange'; }\n        if(obj.date_diff.h >= 6){ color = 'red'; }\n        if(obj.date_diff.d > 0 || obj.date_diff.days > 0){ color = 'red'; }\n        if(obj.date_diff.y > 0 || obj.date_diff.m > 0 || obj.date_diff.d > 0 || obj.date_diff.days > 0){ color = 'red'; }\n      }\n      return color;\n    },\n\n    isAdmin(email = '')\n    {\n      return this.$store.getters.isAdmin(email);\n    },\n\n    isDistributor(email = '')\n    {\n      return this.$store.getters.isDistributor(email);\n    },\n\n    isRestricted()\n    {\n      return this.$store.getters.isRestricted();\n    },\n\n    userCan(permission, subsystem, object_id = null, object_type = '')\n    {\n      return this.$store.getters.userCan(permission, subsystem, object_id, object_type);\n    },\n\n    userLimits(permission, subsystem, object_type = ''){\n      return this.$store.getters.userLimits(permission, subsystem, object_type);\n    },\n\n    convertNodeTypeToGraphRouteName(type){\n      if(type == 'Soil Moisture'){\n        return 'soil_moisture_graph';\n      } else if(type == 'Nutrients'){\n        return 'nutrients_graph';\n      } else if(type == 'Wells'){\n        return 'well_controls_graph';\n      } else if(type == 'Water Meter'){\n        return 'meters_graph';\n      } else {\n        return '';\n      }\n    },\n\n    convertNodeTypeToSubsystem(type){\n      if(type == 'Soil Moisture'){\n        return 'Soil Moisture';\n      } else if(type == 'Nutrients'){\n        return 'Nutrients';\n      } else if(type == 'Wells'){\n        return 'Well Controls';\n      } else if(type == 'Water Meter'){\n        return 'Meters';\n      } else {\n        return '';\n      }\n    },\n\n    /* To be used exclusively with Sensor Dropdowns / Checkbox Lists */\n    convertToInches(val){\n      val = val.replace('mm','');\n      val = parseInt(parseInt(val) / 25) + '\"';\n      return val;\n    },\n\n    /* \" */\n    convertToIndex(val){\n      val = val.replace('mm','');\n      val = parseInt(parseInt(val) / 100);\n      return val;\n    },\n\n    truncateString(str){\n      return str.length <= 24 ? str: (str.substring(0, 21) + '...');\n    }\n\n  }\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('base-header',{staticClass:\"pb-6\",attrs:{\"type\":\"dashboard\"}},[_c('b-row',{staticClass:\"py-4\",attrs:{\"align-v\":\"center\"}},[_c('b-col',[_c('h6',{staticClass:\"h2 text-white d-inline-block mb-0 mr-5\"},[_vm._v(\"Dashboard\")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"mab_spinner light right\"})])],1)],1),_c('b-container',{staticClass:\"mt--6\",attrs:{\"fluid\":\"\"}},[_c('card',{staticClass:\"no-border-card\",attrs:{\"body-classes\":\"px-0 pb-1\",\"footer-classes\":\"pb-2\"}},[_c('b-row',{staticClass:\"nomargin\"},[_c('b-col',{attrs:{\"md\":\"\"}},[_c('b-form-select',{on:{\"change\":_vm.loadDashboardData},model:{value:(_vm.perPage),callback:function ($$v) {_vm.perPage=$$v},expression:\"perPage\"}},[_c('b-form-select-option',{attrs:{\"value\":5}},[_vm._v(\"5\")]),_c('b-form-select-option',{attrs:{\"value\":10}},[_vm._v(\"10\")]),_c('b-form-select-option',{attrs:{\"value\":25,\"selected\":\"\"}},[_vm._v(\"25\")]),_c('b-form-select-option',{attrs:{\"value\":50}},[_vm._v(\"50\")])],1)],1),_c('b-col',{attrs:{\"md\":\"\"}},[_c('b-form-select',{staticClass:\"select-primary pagination-select\",attrs:{\"placeholder\":\"Node Type\"},on:{\"change\":_vm.loadDashboardData},model:{value:(_vm.filterNodeType),callback:function ($$v) {_vm.filterNodeType=$$v},expression:\"filterNodeType\"}},_vm._l((_vm.nodeTypes),function(item,index){return _c('b-form-select-option',{key:index,staticClass:\"select-primary\",attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('b-col',{attrs:{\"md\":\"\"}},[_c('base-input',{attrs:{\"prepend-icon\":\"fas fa-search\"}},[_c('b-input',{attrs:{\"debounce\":1000,\"placeholder\":\"Search...\"},on:{\"update\":_vm.loadDashboardData},model:{value:(_vm.filterText),callback:function ($$v) {_vm.filterText=$$v},expression:\"filterText\"}})],1)],1)],1),_c('b-row',{staticClass:\"nomargin\"},[_c('b-col',{attrs:{\"md\":\"\"}},[_c('b-table',{attrs:{\"striped\":\"\",\"bordered\":\"\",\"outlined\":\"\",\"small\":\"\",\"stacked\":\"lg\",\"responsive\":\"\",\"show-empty\":\"\",\"primary-key\":\"node_address\",\"no-local-sorting\":\"\",\"fields\":_vm.tableColumns,\"items\":_vm.tableData,\"busy\":_vm.bInitialQuery},on:{\"sort-changed\":_vm.sortingChanged,\"update:busy\":function($event){_vm.bInitialQuery=$event}},scopedSlots:_vm._u([{key:\"cell(field_name)\",fn:function(data){return [_c('strong',[(_vm.userCan('Graph', _vm.convertNodeTypeToSubsystem(data.item.node_type), data.item.id, 'O'))?_c('router-link',{attrs:{\"to\":{ \n                    name: _vm.convertNodeTypeToGraphRouteName(data.item.node_type), // meters_graph, well_controls_graph\n                    params: { node_address: data.item.node_address }\n                  }}},[_vm._v(\"\\n                  \"+_vm._s(data.value)+\"\\n                \")]):[_vm._v(\"\\n                  \"+_vm._s(data.value)+\"\\n                \")]],2)]}},{key:\"cell(date_time)\",fn:function(data){return [_c('div',{style:('color:' + _vm.calcLastReadingColor(data.item))},[_vm._v(_vm._s(data.value))])]}},{key:\"cell()\",fn:function(data){return [_vm._v(\"\\n              \"+_vm._s(data.value)+\"\\n            \")]}},{key:\"table-busy\",fn:function(){return [_c('div',{staticClass:\"text-center\"},[_c('div',{staticClass:\"mab_spinner\"})])]},proxy:true},{key:\"emptyfiltered\",fn:function(){return [_c('div',{staticClass:\"text-center\"},[_vm._v(\"\\n                No matches found\\n              \")])]},proxy:true},{key:\"empty\",fn:function(){return [_c('div',{staticClass:\"text-center\"},[_vm._v(\"\\n                No entries found\\n              \")])]},proxy:true}])})],1)],1),_c('div',{staticClass:\"align-right\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('b-row',[_c('b-col',{attrs:{\"md\":\"\"}},[_vm._v(\"\\n            Showing \"+_vm._s(Math.min(1 + (_vm.perPage * (_vm.currentPage-1)), _vm.totalRows))+\" to \"+_vm._s(Math.min((_vm.perPage*(_vm.currentPage-1)) + _vm.perPage, _vm.totalRows))+\" of \"+_vm._s(_vm.totalRows)+\" entries\\n          \")]),_c('b-col',{attrs:{\"md\":\"\"}},[_c('b-pagination',{attrs:{\"total-rows\":_vm.totalRows,\"per-page\":_vm.perPage,\"align\":\"right\"},on:{\"input\":_vm.loadDashboardData},model:{value:(_vm.currentPage),callback:function ($$v) {_vm.currentPage=$$v},expression:\"currentPage\"}})],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"content\">\n    <base-header class=\"pb-6\" type=\"dashboard\">\n      <b-row align-v=\"center\" class=\"py-4\">\n        <b-col>\n          <h6 class=\"h2 text-white d-inline-block mb-0 mr-5\">Dashboard</h6>\n          <div v-show='loading' class='mab_spinner light right'></div>\n        </b-col>\n      </b-row>\n    </base-header>\n    <b-container fluid class=\"mt--6\">\n      \n      <card class=\"no-border-card\" body-classes=\"px-0 pb-1\" footer-classes=\"pb-2\">\n\n        <b-row class='nomargin'>\n          <b-col md>\n            <b-form-select v-model=\"perPage\" @change=\"loadDashboardData\">\n              <b-form-select-option :value=\"5\">5</b-form-select-option>\n              <b-form-select-option :value=\"10\">10</b-form-select-option>\n              <b-form-select-option :value=\"25\" selected>25</b-form-select-option>\n              <b-form-select-option :value=\"50\">50</b-form-select-option>\n            </b-form-select>\n          </b-col>\n          <b-col md>\n            <b-form-select\n              class=\"select-primary pagination-select\"\n              v-model=\"filterNodeType\"\n              @change=\"loadDashboardData\"\n              placeholder=\"Node Type\">\n              <b-form-select-option class=\"select-primary\" v-for=\"(item, index) in nodeTypes\" :key=\"index\" :label=\"item.label\" :value=\"item.value\"></b-form-select-option>\n            </b-form-select>\n          </b-col>\n          <b-col md> \n            <base-input prepend-icon=\"fas fa-search\">\n              <b-input \n                v-model=\"filterText\"\n                :debounce=\"1000\"\n                @update=\"loadDashboardData\"\n                placeholder=\"Search...\">\n              </b-input>\n            </base-input>\n          </b-col>\n        </b-row>\n\n        <b-row class='nomargin'>\n          <b-col md>\n            <b-table\n              striped\n              bordered\n              outlined\n              small\n              stacked=\"lg\"\n              responsive\n              show-empty\n              primary-key=\"node_address\"\n              no-local-sorting\n              @sort-changed=\"sortingChanged\"\n              :fields=\"tableColumns\"\n              :items=\"tableData\"\n              :busy.sync=\"bInitialQuery\">\n\n              <template #cell(field_name)=\"data\">\n                <strong>\n                  <router-link v-if=\"userCan('Graph', convertNodeTypeToSubsystem(data.item.node_type), data.item.id, 'O')\"\n                    :to=\"{ \n                      name: convertNodeTypeToGraphRouteName(data.item.node_type), // meters_graph, well_controls_graph\n                      params: { node_address: data.item.node_address }\n                    }\">\n                    {{ data.value }}\n                  </router-link>\n                  <template v-else>\n                    {{ data.value }}\n                  </template>\n                </strong>\n              </template>\n\n              <template #cell(date_time)=\"data\">\n                <div :style=\"'color:' + calcLastReadingColor(data.item)\">{{ data.value }}</div>\n              </template>\n\n              <template #cell()=\"data\">\n                {{ data.value }}\n              </template>\n\n              <template #table-busy>\n                <div class=\"text-center\">\n                  <div class='mab_spinner'></div>\n                </div>\n              </template>\n\n              <template #emptyfiltered>\n                <div class=\"text-center\">\n                  No matches found\n                </div>\n              </template>\n\n              <template #empty>\n                <div class=\"text-center\">\n                  No entries found\n                </div>\n              </template>\n\n            </b-table>\n\n          </b-col>\n        </b-row>\n\n        <div slot=\"footer\" class='align-right'>\n          <b-row>\n            <b-col md>\n              Showing {{ Math.min(1 + (perPage * (currentPage-1)), totalRows) }} to {{ Math.min((perPage*(currentPage-1)) + perPage, totalRows)  }} of {{ totalRows }} entries\n            </b-col>\n            <b-col md>\n              <b-pagination @input=\"loadDashboardData\" v-model=\"currentPage\" :total-rows=\"totalRows\" :per-page=\"perPage\" align=\"right\"></b-pagination>\n            </b-col>\n          </b-row>\n        </div>\n\n      </card>\n\n    </b-container>\n  </div>\n</template>\n<script>\n\nimport { parse } from 'date-fns';\nimport mab_utils from '../../util/mab-utils';\n\nexport default {\n\n  mixins: [ mab_utils ],\n\n  data() {\n    return {\n      loading: false,\n      tableLoading: false,\n      bInitialQuery: true,\n      tableColumns: [\n        {\n          key: 'field_name',\n          label: 'Field Name',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'node_address',\n          label: 'Node',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'date_time',\n          label: 'Last Update',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'status',\n          label: 'Status %',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'irri_rec',\n          label: 'Irri. rec.',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'eto',\n          label: 'ETo',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'one',\n          label: '24h',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'two',\n          label: '48h',\n          sortable: true,\n          tdClass: 'valign'\n        },\n        {\n          key: 'three',\n          label: '72h',\n          sortable: true,\n          tdClass: 'valign'\n        }\n      ],\n      tableData: [],\n      totalRows: 1,\n      currentPage: 1,\n      perPage: 25,\n      filterText: '',\n      sortBy: this.isAdmin() ? 'node_address' : 'date_time',\n      sortDir: 'desc',\n\n      filterNodeType: 'Soil Moisture',\n      nodeTypes: [\n        { label: 'All Types', value: 'All' },\n        { label: 'Soil Moisture', value: 'Soil Moisture' },\n        { label: 'Nutrients', value: 'Nutrients' },\n        { label: 'Wells', value: 'Wells' },\n        { label: 'Meters', value: 'Water Meter' }\n      ],\n      refreshTimer: null,\n      bInitialQuery: true\n    };\n  },\n  methods: {\n    loadDashboardData()\n    {\n      this.loading = true;\n\n      this.$axios.post(this.$store.state.baseUrl+\"/api/dashboard_table\", {\n        cur_page:  this.currentPage,\n        per_page:  this.perPage,\n        initial:   this.bInitialQuery,\n        node_type: this.filterNodeType,\n        filter:    this.filterText,\n        sort_by:   this.sortBy,\n        sort_dir:  this.sortDir ? 'desc' : 'asc'\n      }).then(resp => {\n\n        this.loading = false;\n\n        // if(this.isAdmin()){\n        //   this.tableColumns.unshift({\n        //     key: 'data_source',\n        //     label: 'Data Source',\n        //     sortable: true,\n        //     tdClass: 'valign'\n        //   });\n        // }\n\n        if(this.isAdmin() || this.userLimits('View', 'Dashboard', 'C').length > 1){\n          this.tableColumns.unshift({\n            key: 'company_name',\n            label: 'Entity',\n            sortable: true,\n            tdClass: 'valign'\n          });\n        }\n\n        this.tableData = resp.data.rows;\n        this.totalRows = resp.data.total;\n\n        if(this.totalRows == 0){ this.currentPage = 1; }\n\n        if(this.bInitialQuery){\n          this.bInitialQuery = false;\n          this.refreshTimer = setInterval(() => { this.loadDashboardData(); }, 60000 * 5);\n        }\n      });\n    },\n\n    sortingChanged(e)\n    {\n      this.sortBy  = e.sortBy;\n      this.sortDir = e.sortDesc;\n      this.loadDashboardData();\n    }\n\n  },\n\n  mounted()\n  {\n    this.loadDashboardData();\n  },\n\n  // filter change reset page\n  watch: { filterText: function(n,o) { this.currentPage = n != o ? 1 : this.currentPage } },\n\n  beforeRouteLeave (to, from, next)\n  {\n    if(this.refreshTimer){\n      clearInterval(this.refreshTimer);\n    }\n    next();\n  }\n};\n</script>\n<style>\n  .no-border-card .card-footer{\n    border-top: 0;\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Dashboard.vue?vue&type=template&id=70a2d9a2&\"\nimport script from \"./Dashboard.vue?vue&type=script&lang=js&\"\nexport * from \"./Dashboard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Dashboard.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}