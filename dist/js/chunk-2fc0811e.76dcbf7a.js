(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fc0811e"],{"2e08":function(t,e,a){var i=a("9def"),s=a("9744"),n=a("be13");t.exports=function(t,e,a,r){var o=String(n(t)),l=o.length,d=void 0===a?" ":String(a),u=i(e);if(u<=l||""==d)return o;var h=u-l,c=s.call(d,Math.ceil(h/d.length));return c.length>h&&(c=c.slice(0,h)),r?c+o:o+c}},"92e6":function(t,e,a){"use strict";a("d608")},9744:function(t,e,a){"use strict";var i=a("4588"),s=a("be13");t.exports=function(t){var e=String(s(this)),a="",n=i(t);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(a+=e);return a}},b7a2:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nifty_gauge",style:"width:"+t.size+"; max-width:"+t.size,attrs:{id:t.uniqid_gen},on:{click:t.emitClick}},[a("div",{staticClass:"inner_wrapper"},[a("svg",{attrs:{viewBox:"0 0 100 100"}},[a("clipPath",{attrs:{id:"clip"}},[a("path",{attrs:{d:"M 50 0 a 50 50 0 0 1 0 100 50 50 0 0 1 0 -100 v 16 a 34 34 0 0 0 0 68 34 34 0 0 0 0 -68"}})]),a("foreignObject",{attrs:{x:"0",y:"0",width:"100",height:"100","clip-path":"url(#clip)"}},[a("div",{staticClass:"gradient",style:t.buildConicGradient(),attrs:{xmlns:"http://www.w3.org/1999/xhtml"}})])])]),a("div",{staticClass:"gauge",style:"transform:translate(-50%, -100%) rotate("+t.capAngle()+"deg);"}),a("div",{staticClass:"knob"}),t.subl?a("span",{staticClass:"subl"},[t._v(t._s(t.subl))]):t._e(),t.subm?a("span",{staticClass:"subm"},[t._v(t._s(t.subm))]):t._e(),t.subr?a("span",{staticClass:"subr"},[t._v(t._s(t.subr))]):t._e(),t.label?a("span",{staticClass:"label"},[t._v(t._s(t.label))]):t._e(),t.tooltip?a("b-tooltip",{attrs:{target:t.uniqid_gen}},[t._v(t._s(t.tooltip))]):t._e()],1)},s=[],n=(a("6b54"),{name:"NiftyGauge",props:{angle:{type:String,default:"0"},size:{type:String,default:""},tooltip:{type:String,default:""},subm:{type:String,default:""},subl:{type:String,default:""},subr:{type:String,default:""},label:{type:String,default:""},stops:{type:Array,default:["from","90deg","#f44336","0%","#f44336","50%","#ffeb3b","60%","#4caf50","75%","#ffeb3b","90%","#f44336","100%"]}},data:function(){return{uniqid_gen:""}},created:function(){this.uniqid_gen=this.uniqid("ngtt_")},methods:{uniqid:function(t){return t+window.Math.random().toString(36)},emitClick:function(){this.$emit("clicked",this.uniqid_gen)},capAngle:function(){return this.angle>90&&(this.angle=90),this.angle<-90&&(this.angle=-90),this.angle},buildConicGradient:function(){for(var t="background-image:conic-gradient(",e=0;e<this.stops.length;e+=2)t=t+this.stops[e]+" "+this.stops[e+1]+(e+2<this.stops.length?", ":"");return t+=")",t}}}),r=n,o=(a("92e6"),a("2877")),l=Object(o["a"])(r,i,s,!1,null,"0e918656",null);e["a"]=l.exports},d608:function(t,e,a){},ef19:function(t,e,a){"use strict";a.r(e);var i,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("base-header",{staticClass:"pb-6",attrs:{type:"nutrients"}},[a("b-row",{staticClass:"py-4",attrs:{"align-v":"center"}},[a("b-col",[a("h6",{staticClass:"h2 text-white d-inline-block mb-0 mr-5"},[t._v("Nutrients - "+t._s(t.field_name)+" ( "+t._s(t.current_node)+" ) - Graph")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mab_spinner light right"})])],1)],1),a("div",{staticClass:"container-fluid mt--6"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("card",{attrs:{"body-classes":"px-0 py-0"}},[a("template",{slot:"header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("base-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"btn",attrs:{disabled:!t.node_id||!t.userCan("Export","Nutrients",t.node_id,"O"),size:"sm",type:"primary",title:"Export device data to a CSV file.",icon:""},nativeOn:{click:function(e){return t.exportGraphCSV()}}},[t._v("\n                  Export CSV\n                ")]),a("base-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"btn",attrs:{disabled:!t.node_id||!t.userCan("Edit","Nutrients",t.node_id,"O"),size:"sm",type:"primary",title:"Navigate to the nutrient node's management screen",icon:""},nativeOn:{click:function(e){return t.goToManage()}}},[t._v("\n                  Manage Nutrients\n                ")])],1)])]),a("div",{staticClass:"card-body"},[a("b-row",[t.related_nodes.length>1?a("b-col",{attrs:{sm:""}},[a("base-input",{attrs:{label:"Current Node"}},[a("el-select",{attrs:{disabled:t.loading},model:{value:t.current_node,callback:function(e){t.current_node=e},expression:"current_node"}},[t._l(t.related_nodes,(function(e,i){return[a("el-option",{key:i,attrs:{label:e,value:e,selected:t.$route.params.node_address}})]}))],2)],1)],1):t._e(),a("b-col",{attrs:{sm:""}},[a("base-input",{attrs:{label:"Graph Type"}},[a("el-select",{attrs:{disabled:t.loading},model:{value:t.graph_type,callback:function(e){t.graph_type=e},expression:"graph_type"}},[a("el-option",{attrs:{label:"Nutrients (RAW)",value:"nutrient"}}),a("el-option",{attrs:{label:"Nutrients (PPM)",value:"nutrient_ppm"}}),a("el-option",{attrs:{label:"Nutrients (PPM Average)",value:"nutrient_ppm_avg"}})],1)],1)],1),a("b-col",{attrs:{sm:""}},[a("base-input",{attrs:{label:"Range"}},[a("el-select",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],attrs:{disabled:t.loading,title:"Choose the time range of data to view."},model:{value:t.sub_days,callback:function(e){t.sub_days=e},expression:"sub_days"}},[a("el-option",{attrs:{label:"Last 24 Hours",value:"1"}}),a("el-option",{attrs:{label:"Last Week",value:"7"}}),a("el-option",{attrs:{label:"Last Two Weeks",value:"14"}}),a("el-option",{attrs:{label:"Last Month",value:"31"}}),a("el-option",{attrs:{label:"Last Year",value:"365"}}),a("el-option",{attrs:{label:"Custom",value:"custom"}})],1)],1)],1),a("b-col",{attrs:{sm:""}},[a("base-input",{directives:[{name:"show",rawName:"v-show",value:"custom"==t.sub_days,expression:"sub_days=='custom'"}],attrs:{label:"Start Date"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.focus,s=e.blur;return a("flat-picker",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}}],staticClass:"form-control datepicker",attrs:{config:{maxDate:t.date_now},placeholder:"Custom Date",title:"A custom start date allows a custom range of data to be viewed."},on:{"on-open":i,"on-close":s},model:{value:t.graph_start_date,callback:function(e){t.graph_start_date=e},expression:"graph_start_date"}})}}])})],1),a("b-col",{attrs:{sm:""}},[a("NiftyGauge",{attrs:{angle:t.nutrient_gauge,size:"100px",subl:t.nutrient_lower,subm:t.nutrient_avg,subr:t.nutrient_upper,label:t.nutrient_label,tooltip:"L: "+t.nutrient_lower+", U: "+t.nutrient_upper+", A: "+t.nutrient_avg+" (PPM)"}})],1)],1),a("highcharts",{ref:"hchart",staticClass:"hc",attrs:{options:t.chartOptions,"update-args":t.chartUpdateArgs}}),a("b-row",[a("b-col",{staticClass:"text-center"},["sm"==t.graph_type?a("b-form-checkbox",{attrs:{name:"check-button",size:"lg",switch:""},on:{change:t.toggleSeriesDragDrop},model:{value:t.zoomOrDrag,callback:function(e){t.zoomOrDrag=e},expression:"zoomOrDrag"}},[t._v("Mode: "+t._s(t.zoomOrDrag?"Drag":"Zoom"))]):t._e()],1)],1)],1)],2)],1)])])],1)},n=[],r=(a("f576"),a("ac6a"),a("a481"),a("bd86")),o=(a("6611"),a("450d"),a("e772")),l=a.n(o),d=(a("7f7f"),a("1f1a"),a("4e4b")),u=a.n(d),h=a("c38f"),c=a.n(h),p=(a("0952"),a("ea7f")),g=a.n(p),_=a("8fe0"),m=a("b7a2"),f=a("3d20"),b=a.n(f);g.a.Pointer.prototype.reset=function(){};var v={mixins:[_["a"]],components:(i={},Object(r["a"])(i,u.a.name,u.a),Object(r["a"])(i,l.a.name,l.a),Object(r["a"])(i,"flatPicker",c.a),Object(r["a"])(i,"NiftyGauge",m["a"]),i),data:function(){var t=this;return{loading:!1,in_progress:!0,current_node:this.$route.params.node_address,node_id:null,field_name:null,graph_start_date:"",graph_type:"",sub_days:"",bInitialQuery:!0,bNotified:!1,related_nodes:[],date_now:"",series:[],chartUpdateArgs:[!0,!0,{duration:1e3}],seriesAdjusted:!1,zoomOrDrag:!1,lastDate:null,exportFileName:"",initial_start_date:null,initial_end_date:null,selection_start:null,selection_end:null,nutrient_lower:0,nutrient_upper:0,nutrient_gauge:0,nutrient_avg:0,nutrient_label:"",yMaxBackup:0,yMinBackup:0,yMin:null,yMax:null,xMin:1e3,xMax:0,lastTimestamp:null,full:0,refill:0,plotOptions:{series:{states:{inactive:{opacity:1}}}},chartTitle:{text:"Loading..",widthAdjust:-300},plotLines:[],resetButton:{text:"Reset",enabled:!0,onclick:function(e){t.resetSeriesData()}}}},computed:{chartOptions:function(){return{credits:{enabled:!1},chart:{type:"line",zoomType:0==this.zoomOrDrag&&"x",panning:!0,panKey:"shift",height:600,resetZoomButton:{position:{x:0,y:-50}}},exporting:{buttons:{contextButton:{enabled:!1},exportButton:{text:"Export",menuItems:["downloadPNG","downloadJPEG","downloadPDF","downloadSVG"]},printButton:{text:"Print",onclick:function(){this.print()}},resetButton:this.resetButton},filename:this.exportFileName},colors:["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"],series:this.series,xAxis:{min:this.xMin,max:this.xMax,type:"datetime",dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:'<span style="fill: #00A04C; font-weight:600">%e %b</span>',week:"%e %b",month:"%b %Y",year:"%Y"},tickPosition:"inside",labels:{rotation:-45},crosshair:!0,events:{setExtremes:function(t){var e=this;setTimeout((function(){"undefined"==typeof t.min&&"undefined"==typeof t.max?e.chart.yAxis[0].setExtremes(e.chart.yAxis[0].min,e.chart.yAxis[0].max):e.chart.yAxis[0].setExtremes()}),1)},afterSetExtremes:this.afterSetExtremes}},yAxis:{tickInterval:1,max:this.yMax,min:this.yMin,minPadding:0,maxPadding:0,title:{text:""},plotLines:this.plotLines},legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},tooltip:{shared:!0},plotOptions:this.plotOptions,title:this.chartTitle}}},watch:{title:function(t){this.chartOptions.title=t},plotOptions:{handler:function(t){t.length&&(this.chartOptions.plotOptions=t)},deep:!0},series:{handler:function(t){t.length&&(this.chartOptions.series=t)},deep:!0},graph_start_date:function(t){this.changeDateRange()},graph_type:function(t){this.maybeReloadGraphData()},sub_days:function(t){("custom"!=t||this.graph_start_date)&&("custom"!=t&&(this.graph_start_date=""),this.initial_start_date=null,this.initial_end_date=null,this.maybeReloadGraphData())},current_node:function(t){this.bNotified=!1,this.maybeReloadGraphData()}},methods:{loadGraphData:function(){var t=this;return this.loading=!0,this.in_progress=!0,this.$refs.hchart.chart.showLoading(this.bInitialQuery?"Loading...":"Refreshing..."),this.$axios.post(this.$store.state.baseUrl+"/api/Graph",{node_address:this.current_node,graph_type:this.graph_type,graph_start_date:this.graph_start_date,sub_days:this.sub_days,is_initial:this.bInitialQuery,selection_start:this.selection_start,selection_end:this.selection_end}).then((function(e){if(t.loading=!1,t.in_progress=!0,t.$refs.hchart.chart.hideLoading(),e.data){if(e.data.message&&"no_data"==e.data.message)return b.a.fire({title:"No data found",text:"This node currently has no data to plot.",showCancelButton:!1,confirmButtonText:"OK",buttonsStyling:!1,customClass:{cancelButton:"btn btn-outline-primary",confirmButton:"btn btn-primary"}}),void(t.chartTitle.text="No data found");!t.bNotified&&e.data.not_current&&e.data.last_date&&(b.a.fire({title:"No recent data found",text:"Last readings up to "+e.data.last_date+" could be displayed.",showCancelButton:!1,confirmButtonText:"OK",buttonsStyling:!1,customClass:{cancelButton:"btn btn-outline-primary",confirmButton:"btn btn-primary"}}),t.bNotified=!0),t.selection_start=null,t.selection_end=null,t.node_id=e.data.node_id,t.field_name=e.data.field_name,t.bInitialQuery&&(t.graph_start_date=e.data.graph_start_date,t.graph_type=e.data.graph_type,t.sub_days=e.data.sub_days),t.nutrient_lower="nutrient_lower"in e.data?e.data.nutrient_lower:0,t.nutrient_upper="nutrient_upper"in e.data?e.data.nutrient_upper:100,t.nutrient_gauge="nutrient_gauge"in e.data?e.data.nutrient_gauge:0,t.nutrient_avg="nutrient_avg"in e.data?e.data.nutrient_avg:0,t.nutrient_label="nutrient_label"in e.data?e.data.nutrient_label:"",t.xMax=e.data.x_max,t.xMin=e.data.x_min,"nutrient_ppm_avg"==t.graph_type?(t.yMax=e.data.y_max,t.yMin=e.data.y_min):(t.yMax=null,t.yMin=null),t.yMaxBackup=e.data.y_max,t.yMinBackup=e.data.y_min,t.full=e.data.full,t.refill=e.data.refill,t.lastDate=e.data.last_date.replace(":","-"),t.exportFileName=e.data.graph.field_name+"-"+t.graph_type+"-"+t.$route.params.node_address+"-"+t.lastDate,t.plotOptions=e.data.graph.plotOptions,t.chartTitle=e.data.graph.title,t.series=e.data.graph.series.filter((function(t){return!!t.data&&t.data.length>0})),t.lastTimestamp=e.data.x_max,("nutrient"==t.graph_type||"nutrient_ppm"==t.graph_type)&&t.zoomOrDrag?t.enableSeriesDragDrop():t.disableSeriesDragDrop(),"nutrient_ppm_avg"==t.graph_type?(t.showPlotLines(),t.setupCustomTooltip()):(t.hidePlotLines(),t.removeCustomTooltip()),t.related_nodes=e.data.related_nodes,t.$refs.hchart.chart.reflow()}return setTimeout((function(){t.in_progress=!1,t.bInitialQuery=!1}),1),e}))},maybeReloadGraphData:function(){1!=this.in_progress&&this.loadGraphData()},changeDateRange:function(){1!=this.in_progress&&""!=this.graph_start_date&&this.loadGraphData()},enableSeriesDragDrop:function(){var t=this;this.series&&this.series.length&&(this.chartOptions.tooltip={shared:!0},this.resetButton.enabled=!0,this.series.forEach((function(e,a){t.series[a].custom={moved:!1},t.series[a].dragDrop={draggableX:!1,draggableY:!0,dragMinY:0,dragMaxY:100,groupBy:"grp"},t.series[a].point={events:{dragStart:function(){this.series.options.custom.moved=!0}}},t.series[a].tooltip={pointFormatter:function(){return'<span style="color:'+this.series.color+';">●</span> '+this.series.name+": <b>"+(this.series.options.custom.moved?"":g.a.numberFormat(this.y,2))+"</b><br/>"}}})),"ave"!=this.graph_type&&(this.yMax=this.yMaxBackup,this.yMin=this.yMinBackup),this.chartTriggerChange())},disableSeriesDragDrop:function(){var t=this;this.series&&this.series.length&&(this.series.forEach((function(e,a){t.series[a].dragDrop={draggableX:!1,draggableY:!1}})),this.chartOptions.tooltip={shared:!1},this.resetButton.enabled=!1,"ave"!=this.graph_type&&(this.yMax=null,this.yMin=null),this.chartTriggerChange())},toggleSeriesDragDrop:function(){this.zoomOrDrag?this.enableSeriesDragDrop():this.disableSeriesDragDrop()},showPlotLines:function(){var t=this;this.plotLines=[{value:this.full,color:"#00F",width:2,label:{x:0,align:"right",formatter:function(){return"Full: "+t.full}}},{value:this.refill,color:"#D26761",width:2,label:{x:0,align:"right",formatter:function(){return"Refill: "+t.refill}}}]},hidePlotLines:function(){this.plotLines=[]},chartTriggerChange:function(){this.series.push({type:"line",name:"Faux",data:[]}),this.series.pop()},exportGraphCSV:function(){var t=this;this.zoomOrDrag=!1;var e=this.$refs.hchart.chart.series;try{for(var a=0;a<e.length;a++)if("undefined"!==typeof e[a].options.custom.moved&&1==e[a].options.custom.moved){this.seriesAdjusted=!0;break}}catch(i){}this.seriesAdjusted?this.resetSeriesData().then((function(e){t.$refs.hchart.chart.downloadCSV()})):this.$refs.hchart.chart.downloadCSV()},resetSeriesData:function(){return this.seriesAdjusted=!1,this.loadGraphData()},setupCustomTooltip:function(){for(var t=0;t<this.series.length;t++)"Average"==this.series[t].name&&(this.series[t].tooltip={pointFormatter:function(){var t='<span style="color:'+this.series.color+';">●</span> '+this.series.name+": <b>"+this.y+"</b><br>";return t}})},removeCustomTooltip:function(){for(var t=0;t<this.series.length;t++)this.series[t].tooltip&&this.series[t].tooltip.pointFormatter&&delete this.series[t].tooltip.pointFormatter},goToManage:function(){this.$router.push({name:"nutrients_edit",params:{node_address:this.current_node}})},afterSetExtremes:function(t){null==t.trigger?this.bInitialQuery&&(this.initial_start_date=this.xMin,this.initial_end_date=this.xMax,this.bInitialQuery=!1):(t.target.chart.resetZoomButton?(this.selection_start=t.min,this.selection_end=t.max):(this.selection_start=this.initial_start_date,this.selection_end=this.initial_end_date),this.maybeReloadGraphData())}},created:function(){var t=new Date,e=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=t.getFullYear();this.date_now=t=i+"-"+a+"-"+e},mounted:function(){this.loadGraphData()}},y=v,x=a("2877"),w=Object(x["a"])(y,s,n,!1,null,null,null);e["default"]=w.exports},f576:function(t,e,a){"use strict";var i=a("5ca1"),s=a("2e08"),n=a("a25f"),r=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n);i(i.P+i.F*r,"String",{padStart:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0,!0)}})}}]);
//# sourceMappingURL=chunk-2fc0811e.76dcbf7a.js.map