(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dbb553b2"],{"0f10":function(e,t,a){},"8fe0":function(e,t,a){"use strict";a("a481");t["a"]={methods:{calcLastReadingColor:function(e){var t="black";return"undefined"!==typeof e.date_diff&&"N/A"!=e.date_diff&&(e.date_diff.h<3&&(t="green"),e.date_diff.h>=3&&e.date_diff.h<6&&(t="orange"),e.date_diff.h>=6&&(t="red"),(e.date_diff.d>0||e.date_diff.days>0)&&(t="red"),(e.date_diff.y>0||e.date_diff.m>0||e.date_diff.d>0||e.date_diff.days>0)&&(t="red")),t},isAdmin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.$store.getters.isAdmin(e)},isDistributor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.$store.getters.isDistributor(e)},isRestricted:function(){return this.$store.getters.isRestricted()},userCan:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.$store.getters.userCan(e,t,a,s)},userLimits:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.$store.getters.userLimits(e,t,a)},convertNodeTypeToGraphRouteName:function(e){return"Soil Moisture"==e?"soil_moisture_graph":"Nutrients"==e?"nutrients_graph":"Wells"==e?"well_controls_graph":"Water Meter"==e?"meters_graph":""},convertNodeTypeToSubsystem:function(e){return"Soil Moisture"==e?"Soil Moisture":"Nutrients"==e?"Nutrients":"Wells"==e?"Well Controls":"Water Meter"==e?"Meters":""},convertToInches:function(e){return e=e.replace("mm",""),e=parseInt(parseInt(e)/25)+'"',e},convertToIndex:function(e){return e=e.replace("mm",""),e=parseInt(parseInt(e)/100),e},truncateString:function(e){return e.length<=24?e:e.substring(0,21)+"..."}}}},c559:function(e,t,a){"use strict";a("0f10")},e880:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("base-header",{staticClass:"pb-6",attrs:{type:"dashboard"}},[a("b-row",{staticClass:"py-4",attrs:{"align-v":"center"}},[a("b-col",[a("h6",{staticClass:"h2 text-white d-inline-block mb-0 mr-5"},[e._v("Dashboard")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mab_spinner light right"})])],1)],1),a("b-container",{staticClass:"mt--6",attrs:{fluid:""}},[a("card",{staticClass:"no-border-card",attrs:{"body-classes":"px-0 pb-1","footer-classes":"pb-2"}},[a("b-row",{staticClass:"nomargin"},[a("b-col",{attrs:{md:""}},[a("b-form-select",{on:{change:e.loadDashboardData},model:{value:e.perPage,callback:function(t){e.perPage=t},expression:"perPage"}},[a("b-form-select-option",{attrs:{value:5}},[e._v("5")]),a("b-form-select-option",{attrs:{value:10}},[e._v("10")]),a("b-form-select-option",{attrs:{value:25,selected:""}},[e._v("25")]),a("b-form-select-option",{attrs:{value:50}},[e._v("50")])],1)],1),a("b-col",{attrs:{md:""}},[a("b-form-select",{staticClass:"select-primary pagination-select",attrs:{placeholder:"Node Type"},on:{change:e.loadDashboardData},model:{value:e.filterNodeType,callback:function(t){e.filterNodeType=t},expression:"filterNodeType"}},e._l(e.nodeTypes,(function(e,t){return a("b-form-select-option",{key:t,staticClass:"select-primary",attrs:{label:e.label,value:e.value}})})),1)],1),a("b-col",{attrs:{md:""}},[a("base-input",{attrs:{"prepend-icon":"fas fa-search"}},[a("b-input",{attrs:{debounce:1e3,placeholder:"Search..."},on:{update:e.loadDashboardData},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)],1)],1),a("b-row",{staticClass:"nomargin"},[a("b-col",{attrs:{md:""}},[a("b-table",{attrs:{striped:"",bordered:"",outlined:"",small:"",stacked:"lg",responsive:"","show-empty":"","primary-key":"node_address","no-local-sorting":"",fields:e.tableColumns,items:e.tableData,busy:e.bInitialQuery},on:{"sort-changed":e.sortingChanged,"update:busy":function(t){e.bInitialQuery=t}},scopedSlots:e._u([{key:"cell(field_name)",fn:function(t){return[a("strong",[e.userCan("Graph",e.convertNodeTypeToSubsystem(t.item.node_type),t.item.id,"O")?a("router-link",{attrs:{to:{name:e.convertNodeTypeToGraphRouteName(t.item.node_type),params:{node_address:t.item.node_address}}}},[e._v("\n                  "+e._s(t.value)+"\n                ")]):[e._v("\n                  "+e._s(t.value)+"\n                ")]],2)]}},{key:"cell(date_time)",fn:function(t){return[a("div",{style:"color:"+e.calcLastReadingColor(t.item)},[e._v(e._s(t.value))])]}},{key:"cell()",fn:function(t){return[e._v("\n              "+e._s(t.value)+"\n            ")]}},{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center"},[a("div",{staticClass:"mab_spinner"})])]},proxy:!0},{key:"emptyfiltered",fn:function(){return[a("div",{staticClass:"text-center"},[e._v("\n                No matches found\n              ")])]},proxy:!0},{key:"empty",fn:function(){return[a("div",{staticClass:"text-center"},[e._v("\n                No entries found\n              ")])]},proxy:!0}])})],1)],1),a("div",{staticClass:"align-right",attrs:{slot:"footer"},slot:"footer"},[a("b-row",[a("b-col",{attrs:{md:""}},[e._v("\n            Showing "+e._s(Math.min(1+e.perPage*(e.currentPage-1),e.totalRows))+" to "+e._s(Math.min(e.perPage*(e.currentPage-1)+e.perPage,e.totalRows))+" of "+e._s(e.totalRows)+" entries\n          ")]),a("b-col",{attrs:{md:""}},[a("b-pagination",{attrs:{"total-rows":e.totalRows,"per-page":e.perPage,align:"right"},on:{input:e.loadDashboardData},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)],1)],1)],1)],1)],1)},r=[],n=a("bd86"),i=a("8fe0"),o={mixins:[i["a"]],data:function(){return Object(n["a"])({loading:!1,tableLoading:!1,bInitialQuery:!0,tableColumns:[{key:"field_name",label:"Field Name",sortable:!0,tdClass:"valign"},{key:"node_address",label:"Node",sortable:!0,tdClass:"valign"},{key:"date_time",label:"Last Update",sortable:!0,tdClass:"valign"},{key:"status",label:"Status %",sortable:!0,tdClass:"valign"},{key:"irri_rec",label:"Irri. rec.",sortable:!0,tdClass:"valign"},{key:"eto",label:"ETo",sortable:!0,tdClass:"valign"},{key:"one",label:"24h",sortable:!0,tdClass:"valign"},{key:"two",label:"48h",sortable:!0,tdClass:"valign"},{key:"three",label:"72h",sortable:!0,tdClass:"valign"}],tableData:[],totalRows:1,currentPage:1,perPage:25,filterText:"",sortBy:this.isAdmin()?"node_address":"date_time",sortDir:"desc",filterNodeType:"Soil Moisture",nodeTypes:[{label:"All Types",value:"All"},{label:"Soil Moisture",value:"Soil Moisture"},{label:"Nutrients",value:"Nutrients"},{label:"Wells",value:"Wells"},{label:"Meters",value:"Water Meter"}],refreshTimer:null},"bInitialQuery",!0)},methods:{loadDashboardData:function(){var e=this;this.loading=!0,this.$axios.post(this.$store.state.baseUrl+"/api/dashboard_table",{cur_page:this.currentPage,per_page:this.perPage,initial:this.bInitialQuery,node_type:this.filterNodeType,filter:this.filterText,sort_by:this.sortBy,sort_dir:this.sortDir?"desc":"asc"}).then((function(t){e.loading=!1,(e.isAdmin()||e.userLimits("View","Dashboard","C").length>1)&&e.tableColumns.unshift({key:"company_name",label:"Entity",sortable:!0,tdClass:"valign"}),e.tableData=t.data.rows,e.totalRows=t.data.total,0==e.totalRows&&(e.currentPage=1),e.bInitialQuery&&(e.bInitialQuery=!1,e.refreshTimer=setInterval((function(){e.loadDashboardData()}),3e5))}))},sortingChanged:function(e){this.sortBy=e.sortBy,this.sortDir=e.sortDesc,this.loadDashboardData()}},mounted:function(){this.loadDashboardData()},watch:{filterText:function(e,t){this.currentPage=e!=t?1:this.currentPage}},beforeRouteLeave:function(e,t,a){this.refreshTimer&&clearInterval(this.refreshTimer),a()}},l=o,d=(a("c559"),a("2877")),c=Object(d["a"])(l,s,r,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-dbb553b2.1e62445c.js.map